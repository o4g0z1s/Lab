<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@300;800&family=BioRhyme+Expanded:wght@300&display=swap" rel="stylesheet">
    <title>Metronautilus</title>
    
    <style>
        html, body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #fff;
            font-family: 'Inter Tight', sans-serif;
            overflow: hidden;
            width: 100%;
            height: 100vh;
        }

        #main-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            filter: blur(200px);
            will-change: filter;
        }

        /* --- Hero View --- */
        #hero-view {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
            
            opacity: 1;
            filter: blur(0px);
            transition: 
                filter 1.5s cubic-bezier(0.22, 1, 0.36, 1),
                opacity 1.5s ease-out;
        }

        #hero-view.fade-out {
            filter: blur(100px);
            opacity: 0;
            pointer-events: none;
        }

        #spiral-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .hero-title {
            margin-top: 0;
            margin-bottom: 30px;
            position: relative;
            z-index: 2;
            text-align: center;
            color: #ffffff;
            mix-blend-mode: difference;
            pointer-events: none;
            line-height: 1;
            opacity: 0;
            animation: fadeIn 1s ease-in forwards;
        }

        .hero-title .small {
            font-size: 2vw;
            font-weight: 300;
            display: block;
            margin: 0;
            letter-spacing: 1.2em;
            font-family: "BioRhyme Expanded";
        }

        .hero-title .large {
            font-size: 13vw;
            font-weight: 800;
            letter-spacing: -0.01em;
            display: block;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        /* --- Category View --- */
        #category-view {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            pointer-events: none; 
        }

        #category-view.active {
            pointer-events: auto;
        }

        .nav-link {
            font-family: "BioRhyme Expanded", serif;
            font-size: 5vw;
            color: #ffffff;
            text-decoration: none;
            margin: 2vh 0;
            position: relative;
            z-index: 2; 
            
            mix-blend-mode: difference;
            
            opacity: 0;
            filter: blur(200px);
            transform: scale(0.95);
            pointer-events: none;
            cursor: default;

            transition: 
                opacity 2s ease-out,
                filter 2.5s cubic-bezier(0.8, 1, 0.01, 1),
                transform 2s;
        }

        .nav-link:hover {
            filter: blur(0px) !important;
        }

        .nav-link.show {
            opacity: 1;
            filter: blur(0px);
            transform: scale(1);
            pointer-events: auto;
            cursor: pointer;
        }

        /* --- Cursor Follower (Teal Circle) --- */
        #cursor-follower {
            position: fixed;
            top: 0;
            left: 0;
            width: 15vw;
            height: 15vw;
            background-color: #008080;
            border-radius: 50%;
            
            filter: blur(40px); 
            pointer-events: none;
            
            z-index: -1; 
            
            margin-left: -7.5vw;
            margin-top: -7.5vw;

            opacity: 0;
            transition: opacity 2s ease;
            will-change: transform;
        }
        
        #cursor-follower.active {
            opacity: 1;
        }

        @media (max-width: 768px) {
            .nav-link { font-size: 10vw; margin: 3vh 0; }
            #cursor-follower { width: 40vw; height: 40vw; margin-left: -20vw; margin-top: -20vw; filter: blur(40px); }
        }
    </style>
</head>

<script src="https://unpkg.com/cursor-effects@latest/dist/browser.js"></script>
<script>
    window.addEventListener("load", function() {
        setTimeout(function() {
            new cursoreffects.bubbleCursor();
            
            const canvases = document.querySelectorAll("canvas");
            canvases.forEach(c => {
              if (getComputedStyle(c).position === "fixed") {
                c.style.filter = "invert(50%) sepia(87%) saturate(1500%) hue-rotate(137deg) brightness(62%) contrast(101%) opacity(0.8)";
                c.style.transition = "opacity 0.1s ease-out";
                c.setAttribute("data-cursor-canvas", "true");
              }
            });
        }, 1100);
    });
</script>

<body>

<div id="main-wrapper">
    
    <!-- Hero View -->
    <div id="hero-view">
        <canvas id="spiral-canvas"></canvas>
        <h1 class="hero-title">
            <span class="small">-Dive with-</span>
            <span class="large">&nbsp;Metr<span style="font-size: 0.01px;">&hairsp;</span>onautilus.</span>
        </h1>
    </div>

    <!-- Category View -->
    <div id="category-view">
        <div id="cursor-follower"></div>
        <a href="arts/@.html" class="nav-link">Arts</a>
        <a href="tools/@.html" class="nav-link">Tools</a>
        <a href="games/@.html" class="nav-link">Games</a>
    </div>

</div>

<script>
    /**
     * 1. Golden Spiral Animation
     */
    const canvas = document.getElementById('spiral-canvas');
    const ctx = canvas.getContext('2d');
    let width, height;
    let rotation = 0;
    let spiralLineWidth = 10;

    function resize() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
        spiralLineWidth = width * 0.009; 
    }
    window.addEventListener('resize', resize);
    resize();

    function drawSpiral() {
        ctx.fillStyle = 'black';
        ctx.fillRect(0, 0, width, height);
        const centerX = width / 2;
        const centerY = height / 2;
        const maxRadius = Math.sqrt(centerX**2 + centerY**2) + 200;

        ctx.beginPath();
        const a = 5; 
        const b = 0.25; 
        const maxTheta = Math.log(maxRadius / a) / b; 
        
        ctx.strokeStyle = 'teal'; 
        ctx.shadowBlur = spiralLineWidth * 3; 
        ctx.shadowColor = 'rgba(0, 255, 255, 0.9)';
        ctx.lineWidth = spiralLineWidth;
        ctx.lineCap = 'round';

        let first = true;
        for (let i = 0; i < maxTheta * 150; i++) {
            const theta = i * 0.05;
            const r = a * Math.exp(b * theta);
            const angle = theta + rotation;
            const x = centerX + r * Math.cos(angle);
            const y = centerY + r * Math.sin(angle);

            if (first) {
                ctx.moveTo(x, y);
                first = false;
            } else {
                ctx.lineTo(x, y);
            }
            if (r > maxRadius * 1.3) break; 
        }
        ctx.stroke();
        rotation -= 0.005;
        requestAnimationFrame(drawSpiral);
    }
    drawSpiral();

    /**
     * 2. Initial Page Load Blur Fade In
     */
    let isPageLoaded = false;
    let isInteractionEnabled = false;

    window.addEventListener('load', () => {
        const wrapper = document.getElementById('main-wrapper');
        let currentBlur = 80;
        let speed = 0.4; 
        const acceleration = 1.05; 

        function removeBlur() {
            if (currentBlur <= 0.1) {
                wrapper.style.filter = 'blur(0px)';
                isPageLoaded = true;
                setTimeout(() => {
                    isInteractionEnabled = true;
                }, 500);
                return; 
            }
            currentBlur -= speed;
            speed *= acceleration;
            if (currentBlur < 0) currentBlur = 0;
            wrapper.style.filter = `blur(${currentBlur}px)`;
            requestAnimationFrame(removeBlur);
        }
        setTimeout(removeBlur, 300);
    });

    /**
     * 3. Cursor Follower Logic
     */
    const follower = document.getElementById('cursor-follower');
    let mouseX = window.innerWidth / 2;
    let mouseY = window.innerHeight / 2;
    let followerX = window.innerWidth / 2;
    let followerY = window.innerHeight / 2;

    window.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
    });

    function animateFollower() {
        followerX += (mouseX - followerX) * 0.08;
        followerY += (mouseY - followerY) * 0.08;

        follower.style.transform = `translate(${followerX}px, ${followerY}px)`;
        requestAnimationFrame(animateFollower);
    }
    animateFollower();

    /**
     * 4. Interaction Transition
     */
    let hasTransitioned = false;

    function triggerTransition() {
        if (!isInteractionEnabled || hasTransitioned) return;
        hasTransitioned = true;

        const heroView = document.getElementById('hero-view');
        const categoryView = document.getElementById('category-view');
        const links = document.querySelectorAll('.nav-link');
        const cursorCanvas = document.querySelector('canvas[data-cursor-canvas="true"]');
        
        // A. Fade Out Hero
        heroView.classList.add('fade-out');

        // B. Fade Out Bubble Cursor
        if (cursorCanvas) {
            cursorCanvas.style.opacity = '0';
        }

        // C. Activate Category View Container
        categoryView.classList.add('active');

        // D. Show Links (Staggered)
        links.forEach((link, index) => {
            setTimeout(() => {
                link.classList.add('show');
            }, index * 350);
        });

        // E. Show Teal Circle Follower (Delayed)
        setTimeout(() => {
            follower.classList.add('active');
        }, 2000); 
    }

    window.addEventListener('click', triggerTransition);
    window.addEventListener('touchstart', triggerTransition);
    window.addEventListener('keydown', triggerTransition);

</script>

</body>
</html>