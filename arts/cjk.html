<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>字</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: black;
            color: white;
        }

        #settings-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 100;
            font-family: serif;
        }

        #settings-container {
            text-align: left;
            padding: 40px;
            border: 1px solid #444;
            border-radius: 12px;
        }
        
        .setting-group {
            margin-bottom: 20px;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        label {
            margin-right: 25px;
        }

        select {
            padding: 8px 12px;
            font-size: 16px;
            font-family: serif;
            border-radius: 4px;
            border: 1px solid #666;
            background-color: #333;
            color: white;
            cursor: pointer;
            width: 150px;
        }

        #start-button {
            display: block;
            width: 100%;
            padding: 12px;
            font-size: 18px;
            font-weight: bold;
            font-family: serif;
            color: black;
            background-color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 30px;
            transition: background-color 0.2s, color 0.2s;
        }
        
        #start-button:hover {
            background-color: #ccc;
        }
        
        #kanji-display-wrapper {
            display: none;
            width: 100%;
            height: 100%;
            justify-content: center;
            align-items: center;
        }

        #kanji-display {
            font-size: 50vmin;
            line-height: 1;
            padding-bottom: 50px;
        }
    </style>
</head>
<body>
    <div id="settings-overlay">
        <div id="settings-container">
            <div class="setting-group">
                <label for="font-selector">書</label>
                <select id="font-selector">
                    <option value="serif">明</option>
                    <option value="sans-serif">角</option>
                </select>
            </div>
            <div class="setting-group">
                <label for="speed-selector">速</label>
                <select id="speed-selector">
                    <option value="Fast">速</option>
                    <option value="Normal" selected>普</option>
                    <option value="Slow">遅</option>
                </select>
            </div>
            <div class="setting-group">
                <label for="order-selector">順</label>
                <select id="order-selector">
                    <option value="normal" selected>普</option>
                    <option value="reverse">逆</option>
                    <option value="random">乱</option>
                </select>
            </div>
            <button id="start-button">始</button>
        </div>
    </div>

    <div id="kanji-display-wrapper">
        <div id="kanji-display"></div>
    </div>

    <script>
        (function() {
            const settingsOverlay = document.getElementById('settings-overlay');
            const startButton = document.getElementById('start-button');
            const fontSelector = document.getElementById('font-selector');
            const speedSelector = document.getElementById('speed-selector');
            const orderSelector = document.getElementById('order-selector');
            const kanjiDisplayWrapper = document.getElementById('kanji-display-wrapper');
            const kanjiDisplayElement = document.getElementById('kanji-display');

            const unicodeRanges = [
                [0x2E80, 0x2E99],
                [0x2E9B, 0x2EF3],
                [0x2F00, 0x2FD5],
                [0x3400, 0x4DB5],
                [0x4E00, 0x9FEF],
                [0xF900, 0xFA6D]
            ];
            const kanjiList = [];
            for (const range of unicodeRanges) {
                for (let codePoint = range[0]; codePoint <= range[1]; codePoint++) {
                    kanjiList.push(String.fromCodePoint(codePoint));
                }
            }
            
            let currentIndex = 0;
            let displayList = [];
            
            const speeds = {
                'Fast': 20,
                'Normal': 60,
                'Slow': 100
            };
            
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            function updateKanji() {
                if (displayList.length === 0) return;
                kanjiDisplayElement.textContent = displayList[currentIndex];
                currentIndex = (currentIndex + 1) % displayList.length;
            }

            startButton.addEventListener('click', function() {
                // 1. 設定値を取得
                const selectedFont = fontSelector.value;
                const selectedSpeed = speeds[speedSelector.value];
                const selectedOrder = orderSelector.value;

                // 順序に応じて表示リストを作成
                displayList = [...kanjiList]; // 元のリストをコピー
                if (selectedOrder === 'reverse') {
                    displayList.reverse();
                } else if (selectedOrder === 'random') {
                    shuffle(displayList);
                }

                // 2. フォントを適用
                const fontStack = selectedFont === 'serif' 
                    ? "serif" 
                    : "sans-serif";
                kanjiDisplayWrapper.style.fontFamily = fontStack;
                // 3. 設定画面を非表示にする
                settingsOverlay.style.display = 'none';
                // 4. 漢字表示エリアを表示する
                kanjiDisplayWrapper.style.display = 'flex';
                // 5. 最初の漢字をすぐに表示
                currentIndex = 0; // インデックスをリセット
                updateKanji();
                // 6. 選択された速度でアニメーションを開始
                setInterval(updateKanji, selectedSpeed);
            });
        })();
    </script>
</body>
</html>